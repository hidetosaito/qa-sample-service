{
   "AWSTemplateFormatVersion":"2010-09-09",
   "Description":"DCS QA Environment",
   "Parameters":{
      "ServiceName":{
         "Description":"Task Service Name [sample|zenoss|...]",
         "Default":"sample",
         "Type":"String",
         "MinLength":"1",
         "MaxLength":"64",
         "AllowedPattern":"[a-zA-Z][a-zA-Z0-9\\-]*",
         "ConstraintDescription":"Service name must begin with a letter and contain only alphanumeric characters."
      },
      "Environment":{
         "Description":"Environment [prod/staging/poc]",
         "Default":"POC",
         "Type":"String",
         "MinLength":"1",
         "MaxLength":"64",
         "AllowedPattern":"[a-zA-Z][a-zA-Z0-9\\-]*",
         "ConstraintDescription":"Environment must begin with a letter and contain only alphanumeric characters."
      }
   },
   "Resources":{
      "DynamoDBTableCriteria":{
         "Type":"AWS::DynamoDB::Table",
         "Properties":{
            "AttributeDefinitions":[
               {
                  "AttributeName":"TicketKey",
                  "AttributeType":"S"
               },
               {
                  "AttributeName":"Host",
                  "AttributeType":"S"
               }
            ],
            "KeySchema":[
               {
                  "AttributeName":"TicketKey",
                  "KeyType":"HASH"
               },
               {
                  "AttributeName":"Host",
                  "KeyType":"RANGE"
               }
            ],
            "ProvisionedThroughput":{
               "ReadCapacityUnits":"10",
               "WriteCapacityUnits":"10"
            },
            "TableName":{
               "Fn::Join":[
                  "-",
                  [
                     "QAPortal",
                     {
                        "Ref":"ServiceName"
                     },
                     {
                        "Ref":"Environment"
                     },
                     "Criteria"
                  ]
               ]
            }
         }
      },
      "DynamoDBTableRawData":{
         "Type":"AWS::DynamoDB::Table",
         "Properties":{
            "AttributeDefinitions":[
               {
                  "AttributeName":"TicketKey",
                  "AttributeType":"S"
               },
               {
                  "AttributeName":"Host",
                  "AttributeType":"S"
               }
            ],
            "KeySchema":[
               {
                  "AttributeName":"TicketKey",
                  "KeyType":"HASH"
               },
               {
                  "AttributeName":"Host",
                  "KeyType":"RANGE"
               }
            ],
            "ProvisionedThroughput":{
               "ReadCapacityUnits":"150",
               "WriteCapacityUnits":"10"
            },
            "TableName":{
               "Fn::Join":[
                  "-",
                  [
                     "QAPortal",
                     {
                        "Ref":"ServiceName"
                     },
                     {
                        "Ref":"Environment"
                     },
                     "RawData"
                  ]
               ]
            }
         }
      },
      "DynamoDBTableQAResult":{
         "Type":"AWS::DynamoDB::Table",
         "Properties":{
            "AttributeDefinitions":[
               {
                  "AttributeName":"TicketKey",
                  "AttributeType":"S"
               },
               {
                  "AttributeName":"Host",
                  "AttributeType":"S"
               },
               {
                  "AttributeName":"Summary",
                  "AttributeType":"N"
               }
            ],
            "KeySchema":[
               {
                  "AttributeName":"TicketKey",
                  "KeyType":"HASH"
               },
               {
                  "AttributeName":"Host",
                  "KeyType":"RANGE"
               }
            ],
            "ProvisionedThroughput":{
               "ReadCapacityUnits":"50",
               "WriteCapacityUnits":"10"
            },
            "TableName":{
               "Fn::Join":[
                  "-",
                  [
                     "QAPortal",
                     {
                        "Ref":"ServiceName"
                     },
                     {
                        "Ref":"Environment"
                     },
                     "QAResult"
                  ]
               ]
            },
            "LocalSecondaryIndexes":[
               {
                  "IndexName":"Summary-index",
                  "KeySchema":[
                     {
                        "AttributeName":"TicketKey",
                        "KeyType":"HASH"
                     },
                     {
                        "AttributeName":"Summary",
                        "KeyType":"RANGE"
                     }
                  ],
                  "Projection":{
                     "ProjectionType":"KEYS_ONLY"
                  }
               }
            ]
         }
      }
   }
}